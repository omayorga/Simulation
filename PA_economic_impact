"""\nPennsylvania Higher Education Economic Impact Analysis\nCounty-Level Analysis with Inflation Adjustment & Real Wage Growth\n\nAuthor: Oscar J. Mayorga\nUpdated: February 17, 2026\nRepository: github.com/omayorga/Simulation\n"""\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pathlib import Path\nfrom datetime import datetime\n\n# Set style\nsns.set_style(\"whitegrid\")\nplt.rcParams['figure.figsize'] = (12, 8)\n\n# ============================================================================\n# INFLATION & WAGE GROWTH PARAMETERS\n# Source: Bureau of Labor Statistics (February 2026)\n# ============================================================================\n\n# Base year for analysis\nBASE_YEAR = 2024\nCURRENT_YEAR = 2026\n\n# Annual inflation rates (CPI-U)\nINFLATION_RATES = {\n    2020: 1.2,\n    2021: 4.7,\n    2022: 8.0,\n    2023: 4.1,\n    2024: 3.4,\n    2025: 2.7,\n    2026: 2.4,  # Current (Jan 2026)\n    2027: 2.2,  # Fed projection\n    2028: 2.1   # Fed projection\n}\n\n# Nominal wage growth rates\nNOMINAL_WAGE_GROWTH = {\n    2020: 2.8,\n    2021: 4.5,\n    2022: 5.6,\n    2023: 4.8,\n    2024: 4.1,\n    2025: 3.7,\n    2026: 4.3,  # Current (Jan 2026)\n    2027: 3.5,  # Projected\n    2028: 3.2   # Projected\n}\n\n# Real wage growth (nominal - inflation)\nREAL_WAGE_GROWTH = {\n    year: NOMINAL_WAGE_GROWTH.get(year, 0) - INFLATION_RATES.get(year, 0)\n    for year in INFLATION_RATES.keys()\n}\n\ndef calculate_inflation_multiplier(from_year, to_year):\n    \"\"\"Calculate cumulative inflation multiplier between two years\"\"\"\n    if from_year == to_year:\n        return 1.0\n    \n    multiplier = 1.0\n    years = range(from_year + 1, to_year + 1) if to_year > from_year else range(to_year + 1, from_year + 1)\n    \n    for year in years:\n        if year in INFLATION_RATES:\n            rate = INFLATION_RATES[year] / 100\n            multiplier *= (1 + rate) if to_year > from_year else (1 / (1 + rate))\n    \n    return multiplier\n\ndef calculate_wage_growth_multiplier(from_year, to_year, use_real_growth=True):\n    \"\"\"\n    Calculate cumulative wage growth multiplier\n    \n    Args:\n        from_year: Starting year\n        to_year: Ending year\n        use_real_growth: If True, use real wage growth; if False, use nominal\n    \n    Returns:\n        Multiplier for wage/salary adjustments\n    \"\"\"\n    if from_year == to_year:\n        return 1.0\n    \n    multiplier = 1.0\n    years = range(from_year + 1, to_year + 1) if to_year > from_year else range(to_year + 1, from_year + 1)\n    \n    growth_rates = REAL_WAGE_GROWTH if use_real_growth else NOMINAL_WAGE_GROWTH\n    \n    for year in years:\n        if year in growth_rates:\n            rate = growth_rates[year] / 100\n            multiplier *= (1 + rate) if to_year > from_year else (1 / (1 + rate))\n    \n    return multiplier\n\ndef adjust_for_inflation(amount, from_year=BASE_YEAR, to_year=CURRENT_YEAR):\n    \"\"\"Adjust dollar amount for inflation\"\"\"\n    return amount * calculate_inflation_multiplier(from_year, to_year)\n\ndef adjust_for_wage_growth(amount, from_year=BASE_YEAR, to_year=CURRENT_YEAR, use_real=True):\n    \"\"\"Adjust salary/wage amount for wage growth\"\"\"\n    return amount * calculate_wage_growth_multiplier(from_year, to_year, use_real)\n\n# Display economic adjustments\nprint(\"=\" * 80)\nprint(\"ECONOMIC ADJUSTMENT FACTORS\")\nprint(\"=\" * 80)\nprint(f\"\\nBase Year: {BASE_YEAR}\")\nprint(f\"Current Year: {CURRENT_YEAR}\\n\")\n\nprint(\"Annual Rates (%):\")\nprint(f\"{'Year':<8} {'Inflation':<12} {'Nominal Wage':<15} {'Real Wage':<12}\")\nprint(\"-\" * 50)\nfor year in sorted(INFLATION_RATES.keys()):\n    if year >= 2024:\n        print(f\"{year:<8} {INFLATION_RATES[year]:<12.1f} {NOMINAL_WAGE_GROWTH[year]:<15.1f} {REAL_WAGE_GROWTH[year]:<12.1f}\")\n\ncumulative_inflation = calculate_inflation_multiplier(BASE_YEAR, CURRENT_YEAR)\ncumulative_wage_real = calculate_wage_growth_multiplier(BASE_YEAR, CURRENT_YEAR, True)\ncumulative_wage_nominal = calculate_wage_growth_multiplier(BASE_YEAR, CURRENT_YEAR, False)\n\nprint(f\"\\nCumulative Changes ({BASE_YEAR} to {CURRENT_YEAR}):\")\nprint(f\"  Inflation: {(cumulative_inflation - 1) * 100:.2f}%\")\nprint(f\"  Nominal wage growth: {(cumulative_wage_nominal - 1) * 100:.2f}%\")\nprint(f\"  Real wage growth: {(cumulative_wage_real - 1) * 100:.2f}%\")\nprint(f\"\\nPurchasing Power:\")\nprint(f\"  $100 in {BASE_YEAR} = ${100 * cumulative_inflation:.2f} in {CURRENT_YEAR} (inflation-adjusted)\")\nprint(f\"  $100 salary in {BASE_YEAR} = ${100 * cumulative_wage_nominal:.2f} in {CURRENT_YEAR} (nominal growth)\")\nprint(f\"  $100 salary in {BASE_YEAR} = ${100 * cumulative_wage_real:.2f} real increase (above inflation)\")\nprint(\"=\" * 80 + \"\\n\")\n\n# ============================================================================\n# DATA DEFINITION - PA County Level\n# ============================================================================\n\npa_counties = {\n    'County': ['Philadelphia', 'Allegheny', 'Montgomery', 'Bucks', 'Delaware', 'Chester', \n               'Lancaster', 'York', 'Berks', 'Westmoreland', 'Luzerne', 'Lackawanna',\n               'Erie', 'Lehigh', 'Northampton', 'Dauphin', 'Cumberland', 'Washington',\n               'Butler', 'Cambria', 'Beaver', 'Lebanon', 'Fayette', 'Schuylkill',\n               'Monroe', 'Centre', 'Blair', 'Mercer', 'Lawrence', 'Crawford',\n               'Lycoming', 'Armstrong', 'Indiana', 'Clearfield', 'Somerset', 'Wayne',\n               'Pike', 'Columbia', 'Bradford', 'Carbon', 'Venango', 'Union',\n               'Tioga', 'Clarion', 'Huntingdon', 'Jefferson', 'Clinton', 'Wyoming',\n               'Warren', 'McKean', 'Greene', 'Susquehanna', 'Mifflin', 'Potter',\n               'Juniata', 'Snyder', 'Perry', 'Montour', 'Fulton', 'Sullivan',\n               'Forest', 'Elk', 'Cameron'],\n    'Population_2024': [1573916, 1231814, 879190, 650131, 584882, 540711,\n                       556651, 456203, 425328, 349331, 321791, 217066,\n                       269728, 370614, 312951, 284983, 260091, 209349,\n                       188472, 132853, 165160, 141735, 128804, 143618,\n                       171826, 163023, 123089, 109763, 85656, 84894,\n                       114188, 65558, 84463, 78597, 74129, 51546,\n                       57369, 65163, 60281, 63639, 51074, 45559,\n                       41144, 38734, 45342, 44492, 37931, 26420,\n                       40187, 40625, 38686, 39702, 46138, 16301,\n                       24692, 40683, 46299, 18240, 14845, 5840,\n                       6938, 30398, 4547],\n    'Region': ['Southeast', 'Southwest', 'Southeast', 'Southeast', 'Southeast', 'Southeast',\n               'Southcentral', 'Southcentral', 'Southeast', 'Southwest', 'Northeast', 'Northeast',\n               'Northwest', 'Northeast', 'Northeast', 'Southcentral', 'Southcentral', 'Southwest',\n               'Northwest', 'Southcentral', 'Northwest', 'Southcentral', 'Southwest', 'Northeast',\n               'Northeast', 'Northcentral', 'Southcentral', 'Northwest', 'Northwest', 'Northwest',\n               'Northcentral', 'Northwest', 'Southwest', 'Northcentral', 'Southwest', 'Northeast',\n               'Northeast', 'Northcentral', 'Northeast', 'Northeast', 'Northwest', 'Northcentral',\n               'Northcentral', 'Northwest', 'Southcentral', 'Northwest', 'Northcentral', 'Northeast',\n               'Northwest', 'Northwest', 'Southwest', 'Northeast', 'Southcentral', 'Northcentral',\n               'Southcentral', 'Northcentral', 'Southcentral', 'Northcentral', 'Southcentral', 'Northcentral',\n               'Northwest', 'Northcentral', 'Northcentral'],\n    'Cost_of_Living_Index': [128.5, 98.7, 118.2, 115.4, 116.8, 119.3,\n                            102.1, 99.8, 103.4, 96.5, 94.2, 95.8,\n                            93.4, 104.7, 103.9, 101.5, 102.8, 95.1,\n                            98.9, 92.8, 95.4, 100.3, 91.7, 92.5,\n                            105.8, 99.4, 93.1, 92.9, 91.8, 90.2,\n                            93.7, 89.5, 92.1, 88.7, 89.9, 98.6,\n                            107.2, 94.1, 91.3, 96.7, 88.9, 97.3,\n                            89.8, 87.4, 88.2, 87.8, 89.1, 93.5,\n                            88.4, 87.9, 90.8, 94.6, 91.5, 86.7,\n                            89.7, 92.4, 95.2, 94.8, 88.5, 90.1,\n                            93.8, 88.6, 87.2]\n}\n\n# ============================================================================\n# ELASTICITY ESTIMATES\n# ============================================================================\n\nelasticity_estimates = {\n    'Overall_Mean': -0.037,\n    'Private_Universities': -0.167,\n    'Public_Universities': 0.003,\n    'Male_Students': -0.361,\n    'Female_Students': -0.017,\n    'Long_Run': -0.062,\n    'Short_Run': -0.010\n}\n\n# ============================================================================\n# TUITION & ECONOMIC PARAMETERS (2024 Base Year)\n# ============================================================================\n\n# Tuition (2024 dollars)\navg_tuition_public_4yr_2024 = 15240\navg_tuition_private_4yr_2024 = 41900\navg_tuition_community_2024 = 6140\npa_weighted_tuition_2024 = 21418\n\n# Average faculty/staff salary (2024 dollars)\navg_faculty_salary_2024 = 82000\navg_staff_salary_2024 = 56000\navg_employee_salary_2024 = 66000\n\n# Apply adjustments to current year\npa_weighted_tuition_inflation = adjust_for_inflation(pa_weighted_tuition_2024)\npa_weighted_tuition_real_wage = adjust_for_wage_growth(pa_weighted_tuition_2024, use_real=True)\n\navg_employee_salary_nominal = adjust_for_wage_growth(avg_employee_salary_2024, use_real=False)\navg_employee_salary_real = adjust_for_wage_growth(avg_employee_salary_2024, use_real=True)\n\n# Multipliers\ndirect_spending_multiplier = 2.20\nemployment_multiplier = 1.65\n\n# ============================================================================\n# CALCULATIONS\n# ============================================================================\n\ndef calculate_county_metrics(df, adjustment_type='nominal_wage'):\n    \"\"\"\n    Calculate enrollment and economic impact metrics\n    \n    adjustment_type options:\n    - 'baseline': 2024 baseline (no adjustment)\n    - 'inflation_only': Inflation-adjusted\n    - 'nominal_wage': Nominal wage growth applied\n    - 'real_wage': Real wage growth (purchasing power increase)\n    \"\"\"\n    \n    enrollment_rates = {\n        'Southeast': 0.52, 'Southwest': 0.48, 'Northeast': 0.42,\n        'Southcentral': 0.45, 'Northwest': 0.38, 'Northcentral': 0.35\n    }\n    \n    df['College_Age_Pop'] = (df['Population_2024'] * 0.09).astype(int)\n    df['Enrollment_Rate'] = df['Region'].map(enrollment_rates)\n    df['Estimated_Enrollment'] = (df['College_Age_Pop'] * df['Enrollment_Rate']).astype(int)\n    \n    # Select appropriate tuition value\n    if adjustment_type == 'baseline':\n        tuition = pa_weighted_tuition_2024\n    elif adjustment_type == 'inflation_only':\n        tuition = pa_weighted_tuition_inflation\n    elif adjustment_type == 'nominal_wage':\n        tuition = adjust_for_wage_growth(pa_weighted_tuition_2024, use_real=False)\n    else:  # real_wage\n        tuition = pa_weighted_tuition_real_wage\n    \n    df['Direct_Spending'] = df['Estimated_Enrollment'] * tuition * direct_spending_multiplier\n    df['Total_Economic_Impact'] = df['Direct_Spending'] * employment_multiplier\n    df['State_Tax_Revenue'] = df['Direct_Spending'] * 0.08\n    df['Local_Tax_Revenue'] = df['Direct_Spending'] * 0.04\n    df['Total_Tax_Revenue'] = df['State_Tax_Revenue'] + df['Local_Tax_Revenue']\n    \n    return df\n\ndef calculate_regional_summary(df):\n    \"\"\"Aggregate county data to regional level\"\"\"\n    regional = df.groupby('Region').agg({\n        'Estimated_Enrollment': 'sum',\n        'Total_Economic_Impact': 'sum',\n        'State_Tax_Revenue': 'sum',\n        'Local_Tax_Revenue': 'sum',\n        'Total_Tax_Revenue': 'sum',\n        'Cost_of_Living_Index': 'mean',\n        'County': 'count'\n    }).round(2)\n    \n    regional.columns = ['Total_Enrollment', 'Economic_Impact', 'State_Tax',\n                       'Local_Tax', 'Total_Tax', 'Avg_COL_Index', 'Num_Counties']\n    \n    return regional.sort_values('Economic_Impact', ascending=False)\n\n# ============================================================================\n# MAIN ANALYSIS\n# ============================================================================\n\nif __name__ == \"__main__\":\n    \n    df = pd.DataFrame(pa_counties)\n    \n    # Calculate all scenarios\n    df_baseline = calculate_county_metrics(df.copy(), 'baseline')\n    df_inflation = calculate_county_metrics(df.copy(), 'inflation_only')\n    df_nominal_wage = calculate_county_metrics(df.copy(), 'nominal_wage')\n    df_real_wage = calculate_county_metrics(df.copy(), 'real_wage')\n    \n    regional_baseline = calculate_regional_summary(df_baseline)\n    regional_inflation = calculate_regional_summary(df_inflation)\n    regional_nominal = calculate_regional_summary(df_nominal_wage)\n    regional_real = calculate_regional_summary(df_real_wage)\n    \n    # ========================================================================\n    # PRINT RESULTS\n    # ========================================================================\n    \n    print(\"=\" * 80)\n    print(\"PENNSYLVANIA HIGHER EDUCATION ECONOMIC IMPACT ANALYSIS\")\n    print(\"With Inflation Adjustment & Real Wage Growth\")\n    print(\"=\" * 80)\n    \n    print(f\"\\nTUITION ADJUSTMENTS:\")\n    print(f\"  {BASE_YEAR} baseline: ${pa_weighted_tuition_2024:,.0f}\")\n    print(f\"  {CURRENT_YEAR} inflation-adjusted: ${pa_weighted_tuition_inflation:,.0f} (+{((pa_weighted_tuition_inflation/pa_weighted_tuition_2024)-1)*100:.1f}%)\")\n    print(f\"  {CURRENT_YEAR} with real wage growth: ${pa_weighted_tuition_real_wage:,.0f} (+{((pa_weighted_tuition_real_wage/pa_weighted_tuition_2024)-1)*100:.1f}%)\")\n    \n    print(f\"\\nEMPLOYEE SALARY ADJUSTMENTS:\")\n    print(f\"  {BASE_YEAR} baseline: ${avg_employee_salary_2024:,.0f}\")\n    print(f\"  {CURRENT_YEAR} nominal wages: ${avg_employee_salary_nominal:,.0f} (+{((avg_employee_salary_nominal/avg_employee_salary_2024)-1)*100:.1f}%)\")\n    print(f\"  {CURRENT_YEAR} real purchasing power: ${avg_employee_salary_real:,.0f} (+{((avg_employee_salary_real/avg_employee_salary_2024)-1)*100:.1f}%)\")\n    \n    print(f\"\\nSTATEWIDE ECONOMIC IMPACT COMPARISON:\")\n    print(f\"  {BASE_YEAR} Baseline: ${df_baseline['Total_Economic_Impact'].sum()/1e9:.2f}B\")\n    print(f\"  {CURRENT_YEAR} Inflation-adjusted: ${df_inflation['Total_Economic_Impact'].sum()/1e9:.2f}B (+{((df_inflation['Total_Economic_Impact'].sum()/df_baseline['Total_Economic_Impact'].sum())-1)*100:.1f}%)\")\n    print(f\"  {CURRENT_YEAR} Nominal wage growth: ${df_nominal_wage['Total_Economic_Impact'].sum()/1e9:.2f}B (+{((df_nominal_wage['Total_Economic_Impact'].sum()/df_baseline['Total_Economic_Impact'].sum())-1)*100:.1f}%)\")\n    print(f\"  {CURRENT_YEAR} Real wage growth: ${df_real_wage['Total_Economic_Impact'].sum()/1e9:.2f}B (+{((df_real_wage['Total_Economic_Impact'].sum()/df_baseline['Total_Economic_Impact'].sum())-1)*100:.1f}%)\")\n    \n    print(\"\\n\" + \"=\" * 80)\n    print(f\"REGIONAL SUMMARY (Real Wage Growth - {CURRENT_YEAR}):\")\n    print(\"=\" * 80)\n    print(regional_real.to_string())\n    \n    # ========================================================================\n    # SAVE OUTPUT FILES\n    # ========================================================================\n    \n    output_dir = Path('output')\n    output_dir.mkdir(exist_ok=True)\n    \n    df_baseline.to_csv(output_dir / f'PA_County_{BASE_YEAR}_Baseline.csv', index=False)\n    df_real_wage.to_csv(output_dir / f'PA_County_{CURRENT_YEAR}_RealWage.csv', index=False)\n    df_nominal_wage.to_csv(output_dir / f'PA_County_{CURRENT_YEAR}_NominalWage.csv', index=False)\n    \n    print(\"\\n\" + \"=\" * 80)\n    print(\"FILES SAVED:\")\n    print(f\"  - output/PA_County_{BASE_YEAR}_Baseline.csv\")\n    print(f\"  - output/PA_County_{CURRENT_YEAR}_RealWage.csv\")\n    print(f\"  - output/PA_County_{CURRENT_YEAR}_NominalWage.csv\")\n    print(\"=\" * 80)\n    \n    # ========================================================================\n    # VISUALIZATIONS\n    # ========================================================================\n    \n    # Figure: Four-scenario comparison\n    fig, ax = plt.subplots(figsize=(14, 7))\n    \n    scenarios = ['2024\\nBaseline', 'Inflation\\nAdjusted', 'Nominal\\nWage Growth', 'Real Wage\\nGrowth']\n    impacts = [\n        df_baseline['Total_Economic_Impact'].sum() / 1e9,\n        df_inflation['Total_Economic_Impact'].sum() / 1e9,\n        df_nominal_wage['Total_Economic_Impact'].sum() / 1e9,\n        df_real_wage['Total_Economic_Impact'].sum() / 1e9\n    ]\n    colors = ['#3498db', '#e67e22', '#e74c3c', '#2ecc71']\n    \n    bars = ax.bar(scenarios, impacts, color=colors, alpha=0.8, edgecolor='black')\n    ax.set_ylabel('Total Economic Impact (Billion $)', fontsize=13, fontweight='bold')\n    ax.set_title('PA Higher Ed Economic Impact: Adjustment Scenarios', fontsize=15, fontweight='bold')\n    ax.grid(axis='y', alpha=0.3)\n    \n    for bar, val in zip(bars, impacts):\n        ax.text(bar.get_x() + bar.get_width()/2, val + 0.5,\n               f'${val:.1f}B', ha='center', va='bottom', fontsize=12, fontweight='bold')\n    \n    plt.tight_layout()\n    plt.savefig(output_dir / 'Economic_Impact_Scenarios.png', dpi=300, bbox_inches='tight')\n    plt.close()\n    \n    print(\"\\nVISUALIZATIONS SAVED:\")\n    print(\"  - output/Economic_Impact_Scenarios.png\")\n    print(\"=\" * 80)\n